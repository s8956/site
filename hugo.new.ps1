#Requires -Version 7.2

Param(
  [ValidateSet('articles', 'faq')]
  [Alias('T')][string]$P_Type = 'articles'
)

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

function Start-Script() {
  New-HugoPost
}

# -------------------------------------------------------------------------------------------------------------------- #
# HUGO: NEW CONTENT.
# -------------------------------------------------------------------------------------------------------------------- #

function New-HugoPost() {
  .\hugo.exe new content -k "$($P_Type)" "drafts/$($P_Type)/$(Get-HugoYear)/$(Get-HugoMonth)/$(Get-HugoTimestamp)_$(Get-HugoRandom)"
}

# -------------------------------------------------------------------------------------------------------------------- #
# ------------------------------------------------< COMMON FUNCTIONS >------------------------------------------------ #
# -------------------------------------------------------------------------------------------------------------------- #

# Year.
function Get-HugoYear() {
  $year = "$(Get-Date -Format 'yyyy')"
  return $year
}

# Month.
function Get-HugoMonth() {
  $month = "$(Get-Date -Format 'MM')"
  return $month
}

# Timestamp.
function Get-HugoTimestamp() {
  $timestamp = "$([DateTimeOffset]::UtcNow.ToUnixTimeMilliseconds())"
  return $timestamp
}

# Random.
function Get-HugoRandom() {
  $random = "$(Get-Random -Minimum 1000 -Maximum 9999)"
  return $random
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------< RUNNING SCRIPT >------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

Start-Script
