#!/usr/bin/bash -e

(( EUID == 0 )) && { echo >&2 "This script should not be run as root!"; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

date="$( command -v date )"
shuf="$( command -v shuf )"
hugo="$( command -v hugo )"

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

init() {
  hugo_new
}

# -------------------------------------------------------------------------------------------------------------------- #
# HUGO: NEW CONTENT.
# -------------------------------------------------------------------------------------------------------------------- #

hugo_new() {
  local type="posts"
  ${hugo} new "${type}/$( _year )/$( _month )/$( _timestamp )_$(_random)"
}

# -------------------------------------------------------------------------------------------------------------------- #
# ------------------------------------------------< COMMON FUNCTIONS >------------------------------------------------ #
# -------------------------------------------------------------------------------------------------------------------- #

# Year.
_year() {
  ${date} -u '+%Y'
}

# Month.
_month() {
  ${date} -u '+%m'
}

# Timestamp.
_timestamp() {
  echo $(( $( ${date} -u '+%s' ) / 1000000 ))
}

# Random.
_random() {
  ${shuf} -i '1000-9999' -n 1 --random-source='/dev/random'
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------< INIT FUNCTIONS >------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

init "$@"; exit 0
