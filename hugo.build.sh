#!/usr/bin/bash -e

(( EUID == 0 )) && { echo >&2 "This script should not be run as root!"; exit 1; }

# -------------------------------------------------------------------------------------------------------------------- #
# CONFIGURATION.
# -------------------------------------------------------------------------------------------------------------------- #

dir=$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd -P )
hugo="$( command -v hugo )"

# -------------------------------------------------------------------------------------------------------------------- #
# INITIALIZATION.
# -------------------------------------------------------------------------------------------------------------------- #

init() {
  build
}

# -------------------------------------------------------------------------------------------------------------------- #
# BUILD.
# -------------------------------------------------------------------------------------------------------------------- #

build() {
  ${hugo} --source "${dir}" --cacheDir "${dir}/cache" --gc --quiet
}

# -------------------------------------------------------------------------------------------------------------------- #
# -------------------------------------------------< INIT FUNCTIONS >------------------------------------------------- #
# -------------------------------------------------------------------------------------------------------------------- #

init "$@"; exit 0
